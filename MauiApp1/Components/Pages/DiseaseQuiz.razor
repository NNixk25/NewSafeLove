@page "/disease-quiz"

<div class="card shadow-lg border-0 rounded-4">
    <div class="card-body p-4">
        <h2 class="text-center mb-4">📝 แบบทดสอบความรู้</h2>

        @if (!quizFinished)
        {
            <div>
                <h5>@questions[currentIndex].Text</h5>

                @foreach (var option in questions[currentIndex].Options)
                {
                    <button class="btn btn-outline-dark w-100 my-2"
                            @onclick="() => SelectAnswer(option)">
                        @option
                    </button>
                }
            </div>
        }
        else
        {
            <div class="text-center">
                <h4>🎉 คุณทำแบบทดสอบเสร็จแล้ว!</h4>
                <p>ได้คะแนน <b>@score</b> / @questions.Count</p>
                <button class="btn btn-primary mt-3" @onclick="RestartQuiz">เริ่มใหม่</button>
            </div>
        }
    </div>
</div>

@code {
    private class Question
    {
        public string Text { get; set; } = "";
        public List<string> Options { get; set; } = new();
        public string CorrectAnswer { get; set; } = "";
    }

    private List<Question> questions = new()
    {
        new Question {
            Text = "โรคเอดส์เกิดจากเชื้ออะไร?",
            Options = new() { "HIV", "HBV", "HCV", "ไข้หวัดใหญ่" },
            CorrectAnswer = "HIV"
        },
        new Question {
            Text = "การใช้ถุงยางอนามัยช่วยป้องกันโรคติดต่อทางเพศสัมพันธ์ได้หรือไม่?",
            Options = new() { "ได้", "ไม่ได้" },
            CorrectAnswer = "ได้"
        },
        new Question {
            Text = "โรคติดต่อทางเพศสัมพันธ์ใดรักษาไม่หายขาด?",
            Options = new() { "หนองใน", "ซิฟิลิส", "เริม", "หนองในเทียม" },
            CorrectAnswer = "เริม"
        }
    };

    private int currentIndex = 0;
    private int score = 0;
    private bool quizFinished = false;

    private void SelectAnswer(string selected)
    {
        if (selected == questions[currentIndex].CorrectAnswer)
        {
            score++;
        }

        if (currentIndex < questions.Count - 1)
        {
            currentIndex++;
        }
        else
        {
            quizFinished = true;
        }
    }

    private void RestartQuiz()
    {
        currentIndex = 0;
        score = 0;
        quizFinished = false;
    }
}
<div class="text-center mt-4">
    <a href="/" class="btn-submit">⬅️ กลับหน้าแรก</a>
</div>